Title: Cloud-init bi-weekly status
Date: 2018-06-18 16:08:00 UTC
Category: status-meeting-minutes
Slug: status-2018-06-18

Meeting information
----------------
 * \#cloud-init: Cloud-init bi-weekly status meeting, 18 Jun at 16:08 &mdash; 17:23 UTC
 * Full logs at [[[http://ubottu.com/meetingology/logs/cloud-init/2018/cloud-init.2018-06-18-16.08.log.html](http://ubottu.com/meetingology/logs/cloud-init/2018/cloud-init.2018-06-18-16.08.log.html)]]



Meeting summary
----------------

### Previous Actions
The discussion about "Previous Actions" started at 16:11.

  *  **LINK**: [https://cloud-init.github.io/status-2018-05-29.html\#status-2018-05-29](https://cloud-init.github.io/status-2018-05-29.html\#status-2018-05-29) 
  *  **ACTION**: blackboxsw review distro dection and empty modules list    [ DONE ]  both robjo's branches are landed as of friday of last week.
  *  **ACTION**: blackboxsw carryover network hotplug vs network maintenance on reboot-only
  *  **LINK**: [https://hackmd.io/NUUO4nndS4CXTItl8Rs6Nw](https://hackmd.io/NUUO4nndS4CXTItl8Rs6Nw) 
  *  **LINK**: expectation is to get the foundation landed this week
  *  **LINK**: [https://trello.com/c/Yp6VG2lP/837-eventpolicy-foundation-for-joyent-and-azure-coldplug](https://trello.com/c/Yp6VG2lP/837-eventpolicy-foundation-for-joyent-and-azure-coldplug) 
  *  **LINK**: [https://code.launchpad.net/~chad.smith/cloud-init/+git/cloud-init/+ref/feature/maintain-network-on-boot](https://code.launchpad.net/~chad.smith/cloud-init/+git/cloud-init/+ref/feature/maintain-network-on-boot) 
  *  **LINK**: [https://hackmd.io/aODzXfa_TOikNtYBLt8erA](https://hackmd.io/aODzXfa_TOikNtYBLt8erA) 
  *  **LINK**: [https://hackmd.io/aODzXfa_TOikNtYBLt8erA](https://hackmd.io/aODzXfa_TOikNtYBLt8erA) 

### Recent Changes
The discussion about "Recent Changes" started at 16:27.

  *  **LINK**: [https://trello.com/b/hFtWKUn3/daily-cloud-init-curtin](https://trello.com/b/hFtWKUn3/daily-cloud-init-curtin) 

### Cloud-init 18.3 release
The discussion about "Cloud-init 18.3 release" started at 16:36.


### Office Hours (next ~30 mins)
The discussion about "Office Hours (next ~30 mins)" started at 16:46.

  *  **ACTION**: rhaper/blackboxsw review [https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904](https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904)
  *  **LINK**: [https://cloud-init.github.io/](https://cloud-init.github.io/) 



Vote results
----------------




Action items, by person
----------------

 * blackboxsw
  * blackboxsw review distro dection and empty modules list    [ DONE ]  both robjo's branches are landed as of friday of last week.
  * blackboxsw carryover network hotplug vs network maintenance on reboot-only
  * rhaper/blackboxsw review [https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904](https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904)
 * robjo
  * blackboxsw review distro dection and empty modules list    [ DONE ]  both robjo's branches are landed as of friday of last week.



Done items
----------------

 * (none)



People present (lines said)
----------------

 * blackboxsw (83)
 * robjo (14)
 * rharper (10)
 * ubot5 (7)
 * smoser (7)
 * meetingology (6)



Full Log
----------------


 16:08 `<blackboxsw>` \#startmeeting Cloud-init bi-weekly status meeting

 16:08 `<meetingology>` Meeting started Mon Jun 18 16:08:07 2018 UTC.  The chair is blackboxsw. Information about MeetBot at [http://wiki.ubuntu.com/meetingology.](http://wiki.ubuntu.com/meetingology.)

 16:08 `<meetingology>` 

 16:08 `<meetingology>` Available commands: action commands idea info link nick

 16:09 `<blackboxsw>` Hi folks and welcome. We've got a big week this week as we are planning on a cloud-init release.  So we will have an additional topic in today's agenda

 16:09 `<smoser>` o/

 16:10 `<blackboxsw>` it's been a few weeks, due to holiday schedules/travel,  our agenda will be as following: Previous Actions, Recent Changes, In-progress develepment, cloud-init release 18.3 and office hours

 16:11 `<blackboxsw>` \#topic Previous Actions

 16:11 `<blackboxsw>` last action items are listed in our meeting minutes at the following url:

 16:11 `<blackboxsw>` \#link [https://cloud-init.github.io/status-2018-05-29.html\#status-2018-05-29](https://cloud-init.github.io/status-2018-05-29.html\#status-2018-05-29)

 16:12 `<blackboxsw>` \#ACTION blackboxsw review distro dection and empty modules list    [ DONE ]  both robjo's branches are landed as of friday of last week.

 16:12 * meetingology blackboxsw review distro dection and empty modules list    [ DONE ]  both robjo's branches are landed as of friday of last week.

 16:13 `<blackboxsw>` that was a carryover from the meeting before I believe.

 16:13 `<blackboxsw>` \#ACTION blackboxsw carryover network hotplug vs network maintenance on reboot-only

 16:13 * meetingology blackboxsw carryover network hotplug vs network maintenance on reboot-only

 16:14 `<blackboxsw>` I think this was the only other unresolved action. Our team has had mutliple followup discussions internally and with mgerts from Joyent/SmartOs as well

 16:14 `<blackboxsw>` smoser: and rharper drew up a hackmd doc related to this work here:

 16:14 `<blackboxsw>` \#link [https://hackmd.io/NUUO4nndS4CXTItl8Rs6Nw](https://hackmd.io/NUUO4nndS4CXTItl8Rs6Nw)

 16:15 `<blackboxsw>` We've come to a conclusion on a common near-term approach that will support cold-plug scenarios by allowing datasources to claim whether or not they will re-render networking on a boot event. This would allow cloud-init to react to network metadata changes across boot and enable/disable those devices accordingly

 16:16 `<blackboxsw>` a WIP branch is available here

 16:16 `<blackboxsw>` \#link expectation is to get the foundation landed this week

 16:16 `<blackboxsw>` and tracked in trello here

 16:16 `<blackboxsw>` \#link [https://trello.com/c/Yp6VG2lP/837-eventpolicy-foundation-for-joyent-and-azure-coldplug](https://trello.com/c/Yp6VG2lP/837-eventpolicy-foundation-for-joyent-and-azure-coldplug)

 16:17 `<robjo>` Note that the metdata ins EC2 is "stale", AFIK, or at least some parts of the data are stale, i.e. they only get refreshed on instance restart

 16:17 `<rharper>` is it instance restart or "re DHCP" ?

 16:17 `<rharper>` ie, bounce the interface ?

 16:17 `<blackboxsw>` \#link [https://code.launchpad.net/~chad.smith/cloud-init/+git/cloud-init/+ref/feature/maintain-network-on-boot](https://code.launchpad.net/~chad.smith/cloud-init/+git/cloud-init/+ref/feature/maintain-network-on-boot)

 16:18 `<smoser>` robjo: that is correct.

 16:18 `<robjo>` so a re-read of the metadata on EC2 delivers no/maybe limited new information

 16:18 `<smoser>` robjo: well, network information is updated.

 16:18 `<smoser>` user-data is only updatable on stop ->` start in ec2

 16:18 `<robjo>` rharper: AFAIK new metadat gets pick up on instance restart

 16:19 `<rharper>` ok

 16:19 `<robjo>` I know the IID also only gets updated on stop-start

 16:19 `<blackboxsw>` certainly in Azure that's the case. you have to stop the instance before changing attached network interfaces and then bring instance online again

 16:20 `<robjo>` Yes, in Azure adding network interfaces is not dynamic

 16:20 `<robjo>` meaning cannot happen while an instance is running

 16:21 `<blackboxsw>` adding IPs in azure is an online thing, but even azure's network metadata is limited in that it doesn't tell you whether a network interface is static or dynamic. examples here:

 16:21 `<blackboxsw>` [https://hackmd.io/aODzXfa_TOikNtYBLt8erA](https://hackmd.io/aODzXfa_TOikNtYBLt8erA)

 16:21 `<blackboxsw>` \#link [https://hackmd.io/aODzXfa_TOikNtYBLt8erA](https://hackmd.io/aODzXfa_TOikNtYBLt8erA)

 16:22 `<robjo>` Also for Azure there exists the "problem" of accelerated networking, i.e. SR-IOV

 16:23 `<robjo>` when accelerated networking is on the SR-IOV interface gets the same MAC address as the "Synthetic nic"

 16:23 `<rharper>` well, they "solved" it by having the kernel auto bond =/

 16:23 `<robjo>` the SR-IOV interface gets bound to the synthetic nic in the kernel, that was a patch that went into the kernel 6-9 months ago

 16:23 `<rharper>` AFAICT, the sriov device just magically comes and goes as it will

 16:24 `<rharper>` so, one shouldn't worry about the silent bonding ...  (I'm being a bit sarcastic here)

 16:24 `<robjo>` yes, but the interface still shows up, so if output from "ip" command is read one has two devices with the same MAC address, only one of which should be configured

 16:25 `<rharper>` we ignore any of the mlx4 driver devices

 16:25 `<rharper>` yes they show up

 16:25 `<robjo>` OK

 16:25 `<rharper>` but the directive we got was to ignore them; and DHCP on the netvsc ones

 16:25 `<blackboxsw>` ...so think that's all I had on action items from previous meeting.

 16:26 `<blackboxsw>` shall we go to next topic?

 16:26 `<robjo>` And that of course works until Msft gets a better HW deal from Intel or someone else for their network cards ;)

 16:26 `<blackboxsw>` heh

 16:26 `<rharper>` robjo: indeed

 16:27 `<blackboxsw>` \#topic Recent Changes

 16:27 `<blackboxsw>` due to a couple vacations and some work travel it's been a slightly slower couple weeks below are the cloud-init changes that have gone in:

 16:28 `<blackboxsw>` - lxd: Delete default network and detach device if lxd-init created them.

 16:28 `<blackboxsw>` (LP: \#1776958)

 16:28 `<blackboxsw>` - openstack: avoid unneeded metadata probe on non-openstack platforms

 16:28 `<blackboxsw>` [Chad Smith] (LP: \#1776701)

 16:28 `<blackboxsw>` - stages: fix tracebacks if a module stage is undefined or empty

 16:28 `<blackboxsw>` [Robert Schweikert] (LP: \#1770462)

 16:28 `<blackboxsw>` - Be more safe on string/bytes when writing multipart user-data to disk.

 16:28 `<ubot5>` Launchpad bug 1776958 in cloud-init "error creating lxdbr0." [Medium,Fix committed] [https://launchpad.net/bugs/1776958](https://launchpad.net/bugs/1776958)

 16:28 `<blackboxsw>` (LP: \#1768600)

 16:28 `<blackboxsw>` - Fix get_proc_env for pids that have non-utf8 content in environment.

 16:28 `<ubot5>` Launchpad bug 1776701 in cloud-init "ec2: xenial unnecessary openstack datasource probes during discovery" [High,Fix committed] [https://launchpad.net/bugs/1776701](https://launchpad.net/bugs/1776701)

 16:28 `<blackboxsw>` (LP: \#1775371)

 16:28 `<blackboxsw>` - tests: fix salt_minion integration test on bionic and later [Chad Smith]

 16:28 `<blackboxsw>` - tests: provide human-readable integration test summary when --verbose

 16:28 `<blackboxsw>` [Chad Smith]

 16:28 `<ubot5>` Launchpad bug 1770462 in cloud-init "Allow empty stages" [Low,Fix committed] [https://launchpad.net/bugs/1770462](https://launchpad.net/bugs/1770462)

 16:28 `<blackboxsw>` - tests: skip chrony integration tests on lxd running artful or older

 16:28 `<blackboxsw>` [Chad Smith]

 16:28 `<ubot5>` Launchpad bug 1768600 in cloud-init "UTF-8 support in User Data (text/x-shellscript) is broken" [Medium,Fix committed] [https://launchpad.net/bugs/1768600](https://launchpad.net/bugs/1768600)

 16:28 `<blackboxsw>` - test: add optional --preserve-instance arg to integraiton tests

 16:28 `<blackboxsw>` [Chad Smith]

 16:28 `<ubot5>` Launchpad bug 1775371 in cloud-init "cloud-init (18.2) fails on decoding proc1 env" [Medium,Fix committed] [https://launchpad.net/bugs/1775371](https://launchpad.net/bugs/1775371)

 16:28 `<blackboxsw>` - netplan: fix mtu if provided by network config for all rendered types

 16:28 `<blackboxsw>` [Chad Smith] (LP: \#1774666)

 16:28 `<ubot5>` Launchpad bug 1774666 in netplan.io (Ubuntu Cosmic) "Bond interfaces stuck at 1500 MTU on Bionic" [Undecided,Confirmed] [https://launchpad.net/bugs/1774666](https://launchpad.net/bugs/1774666)

 16:28 `<blackboxsw>` - tests: remove pip install workarounds for pylxd, take upstream fix.

 16:28 `<blackboxsw>` - subp: support combine_capture argument.

 16:28 `<blackboxsw>` - tests: ordered tox dependencies for pylxd install [Chad Smith]

 16:28 `<blackboxsw>` - util: add get_linux_distro function to replace platform.dist

 16:28 `<blackboxsw>` [Robert Schweikert] (LP: \#1745235)

 16:28 `<blackboxsw>` - pyflakes: fix unused variable references identified by pyflakes 2.0.0.

 16:28 `<ubot5>` Launchpad bug 1745235 in cloud-init "distribution detection" [Medium,Fix committed] [https://launchpad.net/bugs/1745235](https://launchpad.net/bugs/1745235)

 16:28 `<blackboxsw>` thanks again Robert for the contributions here getting cloud-init in order :)

 16:30 `<blackboxsw>` we've also just pushed a release of cloud-init tip into Ubuntu Cosmic.

 16:30 `<blackboxsw>` so all latest changes are in the development series

 16:32 `<blackboxsw>` I think that about wraps it

 16:32 `<blackboxsw>` \#topc In-progress Development

 16:32 `<blackboxsw>` As always, we track ongoing work publicly at

 16:32 `<blackboxsw>` \#link [https://trello.com/b/hFtWKUn3/daily-cloud-init-curtin](https://trello.com/b/hFtWKUn3/daily-cloud-init-curtin)

 16:33 `<blackboxsw>` we've got some cold-plug network rendering handling that will be queued for this week, mgerts is working on enabling cold-plug network rendering support on boot for SmartOS, and there is a followup for Azure to do the same

 16:34 `<blackboxsw>` cloud-init squad is going to be setting up an SRU into Xenial, Artful and Bionic this week as well

 16:34 `<blackboxsw>` to sync latest qualified cloud-init into those Ubuntu series

 16:35 `<smoser>` blackboxsw: thinking out loud..

 16:35 `<smoser>` if we're going to release 18.3 on thursday

 16:35 `<smoser>` might as well just hold off on sru until then

 16:35 `<blackboxsw>` (wait on 18.3 release?)

 16:36 `<blackboxsw>` yeha

 16:36 `<blackboxsw>` yeah even

 16:36 `<blackboxsw>` which brings us to our next topic

 16:36 `<blackboxsw>` \#topic Cloud-init 18.3 release

 16:37 `<blackboxsw>` I hadn't seen any responsed to your email scott to cloud-init@lists.launchpad.net.  Does anyone have any feature pressing that we'd like to get into this release

 16:38 `<blackboxsw>` estimated release would be Thusday of this week

 16:39 `<blackboxsw>` I'd whimsically like to include the azure cold-plug stuff, but that means getting those two branches in shape today for a thorough review/test cycle

 16:39 `<blackboxsw>` s/whimsically/opportunitically/

 16:39 `<blackboxsw>` heh I give up

 16:42 `<blackboxsw>` did we want to pull this in? [https://code.launchpad.net/~paul-meyer/cloud-init/+git/cloud-init/+merge/334989](https://code.launchpad.net/~paul-meyer/cloud-init/+git/cloud-init/+merge/334989)

 16:45 `<blackboxsw>` If there are any pressing bugs or features that need to be in 18.3 we'd like to see them up for review by Wednesday of this week so that we can cut our upstream release. Feel free to send an email to the list    cloud-init@lists.launchpad.net   or this channel if your branch needs to get some eyes.

 16:46 `<blackboxsw>` we'll SRU 18.3 then into Xenial, Artful and Bionic after a complete round of testing.

 16:46 `<blackboxsw>` \#topic Office Hours (next ~30 mins)

 16:46 `<robjo>` :D After 18.3 but before the workshop: [https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904](https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904)

 16:47 `<blackboxsw>` Folks are around for further discussion on any cloud-init topics of interest

 16:47 `<robjo>` then maybe at the workshop we can come up with a way to move SLES & openSUSE to sysconfig renderer

 16:48 `<blackboxsw>` good topic idea

 16:48 `<blackboxsw>` \#ACTION rhaper/blackboxsw review [https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904](https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904)

 16:48 * meetingology rhaper/blackboxsw review [https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904](https://code.launchpad.net/~rjschwei/cloud-init/+git/cloud-init/+merge/333904)

 17:22 `<blackboxsw>` thanks again folks. catch you next time.

 17:23 `<blackboxsw>` minutes will be published to the link below

 17:23 `<blackboxsw>` \#link [https://cloud-init.github.io/](https://cloud-init.github.io/)

 17:23 `<blackboxsw>` \#endmeeting



Generated by MeetBot 0.1.5 ([http://wiki.ubuntu.com/meetingology](http://wiki.ubuntu.com/meetingology))